<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Blog Page</title>
    <!--Bootsrap 5-->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <!--Highlight JS-->
    <link
      rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/default.min.css"
    />
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <script>
      hljs.highlightAll();
    </script>
  </head>

  <body>
    <!--Navbar-->
    <nav
      id="navbar"
      class="navbar navbar-expand-lg navbar-light bg-light"
    ></nav>
    <script src="navbar.js"></script>

    <!--Header-->
    <div class="container py-5">
      <div class="row">
        <div class="col text-center">
          <h1 class="display-1">Example</h1>
        </div>
      </div>
    </div>

    <!--Post-->
    <!--Content-->
    <div class="container">
      <div class="row">
        <div class="col">
          <p>
            I am personally a huge fan of the Knack Database Software. I used it
            to create an internal employee portal that tracks data from
            timesheets, expense reports, invoices, and bills. As an R
            enthusiast, I have sought ways to remotely access and analyze data
            stored on Knack using R. The Knack team has made that possible
            through their API, but the documentation is written in JavaScript
            and can be difficult to translate into R for those not familiar with
            HTTP requests and JSON. I posted two articles on the Knack Forum
            about accessing Knack data using R. You can read about them here. I
            want to discuss my second post: Sending filtered API Requests to
            Knack. Suppose you have thousands of records stored on Knack, but
            you only want to fetch a subset of them to analyze with R. Knack has
            made that possible through their API, but the documentation is
            written in JavaScript. I want to share how I translated the
            JavaScript into R code. You can see below the code that I used to
            retrieve only records specified within a date range.
          </p>
        </div>
      </div>
    </div>

    <!--R Code Snippet-->
    <div class="container">
      <div class="row">
        <div class="col-sm mx-auto px-auto">
          <pre><code class = "language-R">
            # Load dependent packages
            library(jsonlite)
            library(httr)
            
            # Set the api base url
            api_url <-
              "https://api.knack.com/v1/objects/object_23/records"
            
            # Set boundaries for date range
            # The date formatting is necessary
            date_start <- format(as.Date('2021-11-01'), "%m/%d/%Y")
            date_end <- format(as.Date('2021-11-30'), "%m/%d/%Y")
            
            # Set filters
            # Refer to the Knack Documentation for more details
            filters <- list(match = "and",
                            rules = data.frame(
                              field = "field_170",
                              operator = c("is after", "is before"),
                              value = c(date_start, date_end)
                            ))
            
            # Convert filters list to JSON and URL encode
            filters_string <- toJSON(filters, auto_unbox = TRUE)
            api_url <-
              paste0(api_url,
                     '?rows_per_page=1000&filters=',
                     URLencode(filters_string))
            
            # Send the GET request
            result <- GET(
              api_url,
              add_headers(
                "X-Knack-Application-Id" = "YOUR APP ID",
                "X-Knack-REST-API-Key" = "YOUR APP API KEY"
              )
            )
            
            # Retrieve the result
            data <- fromJSON(content(result, as = "text"))
      </code></pre>
        </div>
      </div>
    </div>
  </body>
</html>
